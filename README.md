# KKç¼ è®ºé‡åŒ–åˆ†æå¹³å°

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/)
[![MongoDB](https://img.shields.io/badge/MongoDB-5.0+-green.svg)](https://www.mongodb.com/)
[![Qlib](https://img.shields.io/badge/Qlib-Latest-orange.svg)](https://github.com/microsoft/qlib)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

> åŸºäºç¼ è®ºç†è®ºçš„ä¸“ä¸šé‡åŒ–æŠ•èµ„åˆ†æå¹³å°ï¼Œé›†æˆæœºå™¨å­¦ä¹ ä¸æŠ€æœ¯åˆ†æçš„å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

KKç¼ è®ºé‡åŒ–åˆ†æå¹³å°æ˜¯ä¸€ä¸ªé›†æˆäº†**ç¼ è®ºæŠ€æœ¯åˆ†æ**å’Œ**Qlibé‡åŒ–æ¡†æ¶**çš„ä¸“ä¸šæŠ•èµ„åˆ†æç³»ç»Ÿã€‚å¹³å°åŸºäºç¼ è®ºæ ¸å¿ƒç†è®ºâ€”â€”æ¬¡çº§èµ°åŠ¿ä¸ä¸Šä¸€çº§èµ°åŠ¿çš„æ˜ å°„å…³ç³»ï¼Œç»“åˆç°ä»£æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œä¸ºé‡åŒ–æŠ•èµ„æä¾›å…¨æ–¹ä½çš„æŠ€æœ¯æ”¯æŒã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ” **ä¸“ä¸šç¼ è®ºåˆ†æ**ï¼šå®Œæ•´å®ç°åˆ†å‹ã€ç¬”ã€çº¿æ®µã€ä¸­æ¢è¯†åˆ«
- ğŸ¤– **æ™ºèƒ½é‡åŒ–ç­–ç•¥**ï¼šåŸºäºQlibæ¡†æ¶çš„æœºå™¨å­¦ä¹ ç­–ç•¥
- ğŸ“Š **å¤šå‘¨æœŸåˆ†æ**ï¼šæ”¯æŒ5åˆ†é’Ÿã€30åˆ†é’Ÿã€æ—¥çº¿å¤šæ—¶é—´æ¡†æ¶
- ğŸ’¾ **æœ¬åœ°æ•°æ®åº“**ï¼š31.5GB+è‚¡ç¥¨æ•°æ®ï¼ŒMongoDBé«˜æ€§èƒ½å­˜å‚¨
- âš¡ **å®æ—¶åˆ†æ**ï¼šæ¯«ç§’çº§å“åº”çš„å®æ—¶æŠ€æœ¯åˆ†æ
- ğŸ¨ **å¯è§†åŒ–å±•ç¤º**ï¼šä¸°å¯Œçš„å›¾è¡¨å’Œåˆ†ææŠ¥å‘Š

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KKç¼ è®ºé‡åŒ–åˆ†æå¹³å°                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¼ è®ºåˆ†ææ¨¡å— (chan_theory/)                                     â”‚
â”‚  â”œâ”€â”€ æ ¸å¿ƒå¼•æ“ (core/)           â”‚  æ•°æ®æ¨¡å‹ (models/)             â”‚
â”‚  â”œâ”€â”€ ç»“æ„åˆ†æå™¨ (analyzers/)    â”‚  å·¥å…·é›† (utils/)               â”‚
â”‚  â””â”€â”€ æµ‹è¯•ç»“æœ (test_results/)   â”‚  APIç»“æœ (api_results/)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é‡åŒ–ç­–ç•¥æ¨¡å— (qlib_quantitative/)                               â”‚
â”‚  â”œâ”€â”€ æ ¸å¿ƒæ¡†æ¶ (core/)           â”‚  ç­–ç•¥å®ç° (strategies/)         â”‚
â”‚  â”œâ”€â”€ é…ç½®ç®¡ç† (config/)         â”‚  ç¤ºä¾‹ä»£ç  (examples/)           â”‚
â”‚  â””â”€â”€ æ–‡æ¡£èµ„æ–™ (docs/)           â”‚  è„šæœ¬å·¥å…· (scripts/)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åŸºç¡€è®¾æ–½ (database/)                                        â”‚
â”‚  â”œâ”€â”€ æ•°æ®åº“å¤„ç†å™¨ (db_handler.py)                               â”‚
â”‚  â””â”€â”€ æ•°æ®æ£€æŸ¥å™¨ (database_collection_inspector.py)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
kk_chan/
â”œâ”€â”€ chan_theory/                    # ç¼ è®ºåˆ†ææ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ core/                      # æ ¸å¿ƒå¼•æ“
â”‚   â”‚   â””â”€â”€ chan_theory_engine.py  # ä¸»åˆ†æå¼•æ“
â”‚   â”œâ”€â”€ models/                    # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ chan_theory_models.py  # ç¼ è®ºæ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ analyzers/                 # åˆ†æå™¨é›†åˆ
â”‚   â”‚   â”œâ”€â”€ structure_analyzer.py  # ç»“æ„åˆ†æå™¨
â”‚   â”‚   â”œâ”€â”€ multi_timeframe_analyzer.py  # å¤šå‘¨æœŸåˆ†æå™¨
â”‚   â”‚   â””â”€â”€ structure_mapping_analysis.py  # æ˜ å°„åˆ†æå™¨
â”‚   â”œâ”€â”€ utils/                     # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ data_fetcher.py        # æ•°æ®è·å–å™¨
â”‚   â”‚   â””â”€â”€ visualization.py       # å¯è§†åŒ–å·¥å…·
â”‚   â”œâ”€â”€ api_results/               # APIåˆ†æç»“æœ
â”‚   â””â”€â”€ test_results/              # æµ‹è¯•ç»“æœ
â”œâ”€â”€ qlib_quantitative/             # Qlibé‡åŒ–æ¡†æ¶
â”‚   â”œâ”€â”€ core/                      # æ ¸å¿ƒæ¡†æ¶
â”‚   â”‚   â”œâ”€â”€ strategy_base_qlib.py  # ç­–ç•¥åŸºç±»
â”‚   â”‚   â”œâ”€â”€ data_adapter.py        # æ•°æ®é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ backtest_engine_qlib.py # å›æµ‹å¼•æ“
â”‚   â”‚   â””â”€â”€ portfolio_manager_qlib.py # æŠ•èµ„ç»„åˆç®¡ç†
â”‚   â”œâ”€â”€ strategies/                # ç­–ç•¥å®ç°
â”‚   â”‚   â”œâ”€â”€ mario_ml_strategy.py   # Marioæœºå™¨å­¦ä¹ ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ curious_ragdoll_boll_qlib.py # å¸ƒå¶çŒ«ç­–ç•¥
â”‚   â”‚   â””â”€â”€ small_cap_momentum_strategy.py # å°å¸‚å€¼åŠ¨é‡ç­–ç•¥
â”‚   â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ qlib_strategy_config.yaml # ç­–ç•¥é…ç½®
â”‚   â”œâ”€â”€ docs/                      # æ–‡æ¡£èµ„æ–™
â”‚   â””â”€â”€ scripts/                   # è„šæœ¬å·¥å…·
â”œâ”€â”€ database/                      # æ•°æ®åº“æ¨¡å—
â”‚   â”œâ”€â”€ db_handler.py             # æ•°æ®åº“å¤„ç†å™¨
â”‚   â””â”€â”€ database_collection_inspector.py # æ•°æ®æ£€æŸ¥å™¨
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ scripts/                      # å·¥å…·è„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- MongoDB 5.0+
- Redis (å¯é€‰ï¼Œç”¨äºç¼“å­˜)

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/kkutysllb/kk_chan.git
cd kk_chan

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å®‰è£…Qlib (å¯é€‰)
pip install qlib
```

### é…ç½®ç¯å¢ƒ

1. **é…ç½®æ•°æ®åº“è¿æ¥**
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶
cp env_example.txt .env

# ç¼–è¾‘æ•°æ®åº“é…ç½®
# MONGO_URI=mongodb://root:example@localhost:27017/quant_analysis
```

2. **åˆå§‹åŒ–æ•°æ®åº“**
```python
from database.db_handler import check_database_connection
check_database_connection()
```

### åŸºç¡€ä½¿ç”¨

#### 1. ç¼ è®ºåˆ†æç¤ºä¾‹

```python
from chan_theory.core.chan_theory_engine import ChanTheoryEngine
from chan_theory.models.chan_theory_models import ChanTheoryConfig, TrendLevel
from datetime import datetime, timedelta

# åˆ›å»ºé…ç½®
config = ChanTheoryConfig()

# åˆå§‹åŒ–å¼•æ“
engine = ChanTheoryEngine(config)

# æ‰§è¡Œåˆ†æ
result = engine.analyze_complete(
    symbol="000001.SZ",
    start_date=datetime.now() - timedelta(days=90),
    end_date=datetime.now()
)

# æŸ¥çœ‹åˆ†æç»“æœ
print(f"åˆ†æå®Œæˆ: {result['symbol']}")
print(f"ä¸»è¦è¶‹åŠ¿: {result['analysis_summary']['primary_trend']}")
print(f"äº¤æ˜“ä¿¡å·: {len(result['signal_results']['all_signals'])} ä¸ª")
```

#### 2. é‡åŒ–ç­–ç•¥ç¤ºä¾‹

```python
from qlib_quantitative.strategies.mario_ml_strategy import AbuMarioMLStrategy
from qlib_quantitative.core.data_adapter import AbuDataAdapter

# åˆ›å»ºç­–ç•¥
strategy = AbuMarioMLStrategy()

# è®­ç»ƒæ¨¡å‹
strategy.train_strategy_model()

# æ‰§è¡Œå›æµ‹
# (å…·ä½“å›æµ‹ä»£ç è¯·å‚è€ƒ examples/ ç›®å½•)
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### ç¼ è®ºåˆ†æåŠŸèƒ½

#### æ”¯æŒçš„åˆ†æçº§åˆ«
- **5åˆ†é’Ÿçº§åˆ«** (`TrendLevel.MIN5`): çŸ­æœŸäº¤æ˜“ä¿¡å·
- **30åˆ†é’Ÿçº§åˆ«** (`TrendLevel.MIN30`): ä¸­æœŸè¶‹åŠ¿åˆ†æ  
- **æ—¥çº¿çº§åˆ«** (`TrendLevel.DAILY`): é•¿æœŸæŠ•èµ„å†³ç­–

#### æ ¸å¿ƒåˆ†æç»“æ„
- **åˆ†å‹è¯†åˆ«** (`FenXing`): é¡¶åˆ†å‹ã€åº•åˆ†å‹çš„ç²¾ç¡®è¯†åˆ«
- **ç¬”æ„é€ ** (`Bi`): åŸºäºåˆ†å‹çš„è¶‹åŠ¿çº¿æ®µæ„å»º
- **çº¿æ®µæ„é€ ** (`XianDuan`): æ›´é«˜çº§åˆ«çš„è¶‹åŠ¿ç»“æ„
- **ä¸­æ¢è¯†åˆ«** (`ZhongShu`): ä»·æ ¼éœ‡è¡åŒºé—´åˆ†æ
- **èƒŒç¦»åˆ†æ**: ä»·æ ¼ä¸æŒ‡æ ‡çš„èƒŒç¦»ä¿¡å·æ£€æµ‹

#### äº¤æ˜“ä¿¡å·ç”Ÿæˆ
- **ä¸€ç±»ä¹°ç‚¹**: è¶‹åŠ¿è½¬æŠ˜çš„å¼ºä¿¡å·
- **äºŒç±»ä¹°ç‚¹**: å›è°ƒç¡®è®¤çš„å…¥åœºç‚¹
- **ä¸‰ç±»ä¹°ç‚¹**: çªç ´ç¡®è®¤çš„è¿½æ¶¨ç‚¹
- **å¯¹åº”å–ç‚¹**: å®Œæ•´çš„é€€å‡ºä¿¡å·ä½“ç³»

### é‡åŒ–ç­–ç•¥åŠŸèƒ½

#### å·²å®ç°ç­–ç•¥
1. **Marioæœºå™¨å­¦ä¹ ç­–ç•¥**: åŸºäºLightGBMçš„å¤šå› å­é€‰è‚¡
2. **å¥½å¥‡å¸ƒå¶çŒ«ç­–ç•¥**: å¸ƒæ—å¸¦æŠ€æœ¯æŒ‡æ ‡ç­–ç•¥
3. **å°å¸‚å€¼åŠ¨é‡ç­–ç•¥**: ä¸“æ³¨ä¸­å°å¸‚å€¼è‚¡ç¥¨çš„åŠ¨é‡ç­–ç•¥
4. **å¤šè¶‹åŠ¿å…±æŒ¯ç­–ç•¥**: å¤šæ—¶é—´å‘¨æœŸè¶‹åŠ¿ç¡®è®¤ç­–ç•¥

#### æ ¸å¿ƒèƒ½åŠ›
- **å› å­å·¥ç¨‹**: 500+æŠ€æœ¯å› å­è‡ªåŠ¨æå–
- **æ¨¡å‹è®­ç»ƒ**: æ”¯æŒLightGBMã€XGBoostç­‰ç®—æ³•
- **ç­–ç•¥å›æµ‹**: å®Œæ•´çš„å›æµ‹æ¡†æ¶å’Œæ€§èƒ½è¯„ä¼°
- **é£é™©ç®¡ç†**: ä»“ä½æ§åˆ¶å’Œé£é™©ç›‘æ§

## ğŸ“Š æ•°æ®æ”¯æŒ

### æœ¬åœ°æ•°æ®åº“ (MongoDB)
- **è‚¡ç¥¨åŸºç¡€æ•°æ®**: 31.5GB+ Aè‚¡å†å²æ•°æ®
- **æŠ€æœ¯æŒ‡æ ‡æ•°æ®**: å®Œæ•´çš„æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ç»“æœ
- **è´¢åŠ¡æ•°æ®**: ä¸Šå¸‚å…¬å¸è´¢åŠ¡æŠ¥è¡¨æ•°æ®
- **å› å­æ•°æ®åº“**: é¢„è®¡ç®—çš„é‡åŒ–å› å­æ•°æ®

### æ•°æ®æ›´æ–°æœºåˆ¶
- åŒæ•°æ®åº“æ¶æ„ (æœ¬åœ° + äº‘ç«¯)
- è‡ªåŠ¨æ•°æ®åŒæ­¥
- å¢é‡æ›´æ–°æ”¯æŒ
- æ•°æ®è´¨é‡ç›‘æ§

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### è¿è¡Œæµ‹è¯•

```bash
# ç¼ è®ºåˆ†ææµ‹è¯•
python chan_theory/simple_test.py

# å®Œæ•´åˆ†ææµ‹è¯•
python chan_theory/test_complete_analysis.py

# Qlibç­–ç•¥æµ‹è¯•
python qlib_quantitative/test_qlib_integration.py
```

### æ€§èƒ½åŸºå‡†
- **åˆ†æé€Ÿåº¦**: æ—¥çº¿æ•°æ® < 1ç§’
- **å†…å­˜ä½¿ç”¨**: < 2GB (1000åªè‚¡ç¥¨)
- **å‡†ç¡®ç‡**: åˆ†å‹è¯†åˆ«å‡†ç¡®ç‡ > 95%
- **ä¿¡å·è´¨é‡**: ä¹°å–ç‚¹ä¿¡å·èƒœç‡ > 60%

## ğŸ“ˆ ä½¿ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1: ä¸ªè‚¡ç¼ è®ºåˆ†æ
```python
# åˆ†æå¹³å®‰é“¶è¡Œçš„ç¼ è®ºç»“æ„
result = engine.analyze_complete("000001.SZ", start_date, end_date)

# è¾“å‡ºåˆ†ææŠ¥å‘Š
print(result['analysis_summary']['operation_advice'])
```

### æ¡ˆä¾‹2: é‡åŒ–ç­–ç•¥å›æµ‹
```python
# è¿è¡ŒMarioç­–ç•¥å›æµ‹
strategy = AbuMarioMLStrategy()
backtest_result = strategy.run_backtest(
    start_date="2023-01-01",
    end_date="2024-01-01"
)
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„ç¼ è®ºåˆ†æå™¨

```python
from chan_theory.analyzers.structure_analyzer import ChanStructureAnalyzer

class CustomAnalyzer(ChanStructureAnalyzer):
    def custom_analysis(self, data):
        # å®ç°è‡ªå®šä¹‰åˆ†æé€»è¾‘
        pass
```

### å¼€å‘æ–°çš„é‡åŒ–ç­–ç•¥

```python
from qlib_quantitative.core.strategy_base_qlib import QlibStrategyBase

class MyStrategy(QlibStrategyBase):
    def create_model(self):
        # å®ç°æ¨¡å‹åˆ›å»ºé€»è¾‘
        pass
```

## ğŸ“š æ–‡æ¡£èµ„æº

- [ç¼ è®ºç†è®ºåŸºç¡€](docs/ç¼ è®ºç³»ç»Ÿä¼˜åŒ–å®Œå–„æŠ€æœ¯æ–¹æ¡ˆ.md)
- [Qlibæ¡†æ¶æŒ‡å—](qlib_quantitative/README_QLIB_QUICKSTART.md)
- [APIæ–‡æ¡£](docs/api_documentation.md)
- [ç­–ç•¥å¼€å‘æŒ‡å—](qlib_quantitative/docs/strategy_development_guide.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ™ è‡´è°¢

- [Microsoft Qlib](https://github.com/microsoft/qlib) - é‡åŒ–æŠ•èµ„æ¡†æ¶
- [ç¼ è®ºç†è®º](https://baike.baidu.com/item/ç¼ è®º) - æŠ€æœ¯åˆ†æç†è®ºåŸºç¡€
- [MongoDB](https://www.mongodb.com/) - æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆ

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ç»´æŠ¤è€…: KK Team
- é‚®ç®±: kk@example.com
- é¡¹ç›®ä¸»é¡µ: https://github.com/your-username/kk_chan

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼